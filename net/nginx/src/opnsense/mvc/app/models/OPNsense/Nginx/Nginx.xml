<model>
  <mount>//OPNsense/Nginx</mount>
  <description>nginx web server, reverse proxy and waf</description>
  <items>
    <general>
      <enabled type="BooleanField">
        <default>0</default>
        <Required>Y</Required>
      </enabled>
      <enable_redis_plugin type="BooleanField">
        <default>0</default>
        <Required>Y</Required>
      </enable_redis_plugin>
    </general>

    <userlist type="ArrayField">
      <name type="TextField">
        <Required>Y</Required>
      </name>
      <users type="ModelRelationField">
        <Model>
          <template>
            <source>OPNsense.Nginx.Nginx</source>
            <items>credential</items>
            <display>username</display>
          </template>
        </Model>
        <ValidationMessage>Selected user not found</ValidationMessage>
        <Required>Y</Required>
      </users>
    </userlist>

    <credential type="ArrayField">
      <username type="TextField">
        <Required>Y</Required>
      </username>
      <password type="TextField">
        <Required>N</Required>
      </password>
    </credential>

    <upstream type="ArrayField">
      <description type="TextField">
        <Required>Y</Required>
      </description>
      <serverentries type="ModelRelationField">
        <Model>
          <template>
            <source>OPNsense.Nginx.Nginx</source>
            <items>upstream_server</items>
            <display>description</display>
          </template>
        </Model>
        <ValidationMessage>Selected server not found</ValidationMessage>
        <Required>Y</Required>
      </serverentries>
    </upstream>

    <upstream_server>
      <description type="TextField">
        <Required>Y</Required>
      </description>
      <server type="HostField">
        <Required>Y</Required>
      </server>
      <priority type="IntegerField">
        <MinimumValue>0</MinimumValue>
        <Required>Y</Required>
      </priority>
    </upstream_server>

    <location>
      <urlpattern type="TextField">
        <Required>Y</Required>
      </urlpattern>
      <!-- TODO fill data -->
      <matchtype type="OptionField">
        <default>0</default>
        <Required>Y</Required>
      </matchtype>
      <enable_secrules type="BooleanField">
        <default>0</default>
        <Required>Y</Required>
      </enable_secrules>
      <xss_block_score type="IntegerField">
        <Required>N</Required>
      </xss_block_score>
      <sqli_block_score type="BooleanField">
        <Required>N</Required>
      </sqli_block_score>
      <serverentries type="ModelRelationField">
        <Model>
          <template>
            <source>OPNsense.Nginx.Nginx</source>
            <items>custom_policy</items>
            <display>name</display>
          </template>
        </Model>
        <ValidationMessage>Selected server not found</ValidationMessage>
        <Required>Y</Required>
      </serverentries>
      <root type="TextField">
        <Required>N</Required>
      </root>
      <index type="CSVListField">
        <Required>N</Required>
      </index>
      <autoindex type="BooleanField">
        <Required>N</Required>
      </autoindex>
      <authbasic type="TextField">
        <Required>N</Required>
      </authbasic>
      <authbasicuserfile type="ModelRelationField">
        <Model>
          <template>
            <source>OPNsense.Nginx.Nginx</source>
            <items>userlist</items>
            <display>name</display>
          </template>
        </Model>
        <ValidationMessage>Selected server not found</ValidationMessage>
        <Required>Y</Required>
      </authbasicuserfile>
      <force_https type="TextField">
        <Required>N</Required>
      </force_https>
    </location>
    <!-- TODO add settings.xml stuff -->

  </items>
</model>
